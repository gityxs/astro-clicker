(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6570:function(e,t,r){Promise.resolve().then(r.bind(r,7150))},7150:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Page}});var s=r(7437),i=r(7180),n=r(2265),a=r(4249),o=r(7162),l=r(6691),c=r.n(l);r(393);let u={carbon:{src:"/_next/static/media/carbon.0eaabe27.png",height:256,width:256,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAABAElEQVR42mOAgfv3H+j0T5i4pam55dDxEyesGWDg+YsXCuvWr15YWV74NzjQ57+Onv7/oOCQ/x0dXeuOHjuuw7Bo0cL29pbK/1N7a/7WlKT9iYkI/Ovi6vbH1NLuf1d3z2KGyZMn1SdEB/3vaiz83dta/j86Ovy/obnNH3E5tf9NTc0zGPon9Df4erv8jwp2+50YFfDf2MzyP6+U2h9xWdX/jY1NMxlmzZrVbGZm9p+ZgeGvv4/7Xwsrm78MQLa4tNL/nt7e+Qx3794VnzBx4qyw8PD/8vLy/3mEpP4HBoX87+3rn3vp0mV5Bhi4fPmycWNT06GGhsbDV65cMYKJAwB9v3PXrdfiAwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},copper:{src:"/_next/static/media/copper.4b1ed02f.png",height:256,width:256,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAA10lEQVR42mPYt3UzEwMmYALh85evMIJ5Z8+elT16cL/P6f17bM6fPWuAoXxpb9vB1oTg/8WRAf8nVxd/mt5Sf2zp5L51L77+4GbYtW1rXENMwH8/BoY/mVoMfwsNGP5XmzH878iI/X/8zDljhkU9LddyFRn+pxuL/iy1kfqdbyr6q8me4WeWter/FQvmr2LYsnJp5oSy3M+1Ia7/sy2V/qdbqACtCvo/pafr4P7du3QYQOD1//+CG9auDZo9aULf3BnT63bu3WcDd+DMpkpmBuyA8eD+fUwATrZgUHP9qZkAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},gold:{src:"/_next/static/media/gold.c45984bc.png",height:256,width:256,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAABCElEQVR42mOAgedXT9ue3TTp+My+9p2nTp8zYoCBB3euGHx/umXT50st/+8eafmfaqv1vyrQ8/+KiV0rbl05r8gwf9rEJcu74v7fP1jy5931GX+7/Uz+1hky/K32Mv2/Yt7scobZTU3Tp5kz/F8Sw/Jnerb9/+lxpv83JDD8meqv/n/VlMm5DFsra+Y8WOzy/+udil/t9uz/V5dp/P/xqOrXlQmW/w909xYybOyaNPnSPMf/f89a/T+WL/jn4XKJP38umf+/NMXr/5G5C7MYDh36wndr/9zSD7uTXh7Pk/n/fLnZ/08nc+7c3bg45cP//+wMMHDtxX/Bs8umzri3ZnbL////mWDiAMAtjpl8cFDxAAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},iron:{src:"/_next/static/media/iron.96647676.png",height:256,width:256,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAABB0lEQVR42mOAgeev3+lv2Lb94Kz5C45cvHhZjwEG3nz4oPjs2d2l926f+79tx/r/zV2d/xvb2/7OmDNn3ZGjxzUYdu7Z07Nzx7r/j++e/nv/7rm/u/du+dvQVPPX3T/o/7QZsyYxzJozv76oNP//7Jk9fw7s2/R/4sTO/8q6xr9VDaz+T5g0pZ1hzrz5VYlpKf9b2mp+T5rY/l9Sw/S/tJ7Fb2Mb5//TZ85qYliwcFGjb1Dw/5DI0H8JyQl/zWyd/zJI6P+3cvb/P3f+wlaGGzdvSvRPmDgzOjb+n4eP939VQ9v/MQnpv6ZOm9V95/ZtYQYYuHHjhm5jc8uBltaOPS9evFCGiQMAqgGHLhaRtFkAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},platinum:{src:"/_next/static/media/platinum.d4ad7cba.png",height:256,width:256,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAA3ElEQVR42mM4cuQoEwMmYEpJz2E6ffo0I5h35swZ2RMnTvhcuXLF5sKFCwYYyrfv2HFw7rz5/9s7Ov8vXbrs0/IVK49t2bJ13Z3bt7gZ9u/fHzdz1qz/hUXFf7q6e/5OnjL1/xyg4vnzF/4/fPiwMcPmLVuuTZg06X9rW8fPadNn/J44adKvpcuW/2zv6Pi/YcOGVQx79u7NXLxkyecZM2f+7+7p/Q+S6Ozs/D9v3ryDQBN0GEDgxvXrgpu3bA5asmRJ3+LFi+q2bd1qA3fg6jVrmBmwA8YjR44wAQAD63Skntg+zwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},red_mercury:{src:"/_next/static/media/red_mercury.92cdc3ab.png",height:256,width:256,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAA10lEQVR42mPYtXkzEwMmYALhi1evMjKAwNmzZ2UP79/vc2z3bptzZ88aYCif3dp2sCwo+H+Gf8D/zqLiT3119cfm9vate/fzBzfDjq1b44r8/P+bMTD8CWFg+BvNwPA/hYHhf3V07P+T584ZM8xsbrkWysDwP4RL6GeikPjvKB6hX9kMDD8jFJX/L5k/fxXD+qVLM1tzcj/nOrv8j5BV+B8KlMgIDPo/savr4N5du3QYQODL//+C69auDZo+YULfrOnT63bv22cDd+CEikpmBuyA8cC+fUwAVOFcVpI+IU8AAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},shungite:{src:"/_next/static/media/shungite.c637f2ab.png",height:256,width:256,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAA2klEQVR42mPYt+soEwMmAIrlMJ2/eJoRzDt79ozs0cMnfM4cu2Jz/twFAwzly2bvONhWNv9/SUbn/ymdyz7N6Ft5bNncreuev7vFzbBrx/64psJZ/wNNi//khPT8LYme+r82Zf7/zuqF/4+fPGzMsGTmlmsFoZP+Z4Z0/KxImPG7MHLSr9bs5T9zwjv+r1iyYRXDlvV7Mye2LvlcnzPzf15EL0jh/5L0zv9TJ8w7uH/vYR0GEHj55brghnWbg2ZPW9I3d9aiup27t9rAHTh7whpmBuyA8eCBI0wAynts56eipYkAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},silver:{src:"/_next/static/media/silver.38f16162.png",height:256,width:256,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAA2ElEQVR42mPYt38fEwMmYALh8+fOM4J5Z8+elT167KjPmbOnbc6fP2+AoXz5qqUH27tb/5dWFP+fMn3ypxmzZxxbtmLZuudPn3Mz7N69K665reF/ULj/n9yirL+lVUX/65pr/nf1dv4/fuy4McOSZYuvFZbl/s/Kz/hZWVf2u6g8/1dbd/PP3MLM/ytWrljFsHXblsxJUyd8rm+u/Z9fnA1UmA60quj/1GlTDu7fv0+HAQRePnstuGHDhqDZc2b1zZ03p27njp02cAfOnjeLmQE7YDx46CATADX4bBBbXAq9AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},silicon:{src:"/_next/static/media/silicon.8e731ebd.png",height:256,width:256,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAABBElEQVR42mOAgZd3niq3902aPWnajO7///+LMcDAg+e3FVbvWzEze0Hl9/q95f/DZqf8j2sp+jBz5fzey9euSzLMXz9/Xs280v8dG2r+r7za+6d6a8mfgKbw/44Z4f+nzJrXwtDY3TmzeFnB/3kn23/P2971v6A7879qkstvSXeb/1290xsYWvu7Z+StKfi/6NHkP9GTkv/71IT+T91d8Uc51v9/d9eUeob+WVMWmRb4/HeeFvM7viPxb2B/wl+j2oA/HNrO/yfNXdrBsPfAIcOG7va9gfnR/82z3P4z6Ov9dw9N/t86YdqqY6evqDDAwPbtO33KWxqvNvb077lw7Y4JTBwAxKWDXcsPN1wAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},uranium:{src:"/_next/static/media/uranium.f8da526c.png",height:256,width:256,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAA2UlEQVR42mPYvGczEwMmYALhKxeuMjKAwNmzZ2UPHNnvs+fkbpuz588aYChvX9B6MLQ26H9grv//kt6iT/WT6o71Lexd9+P1D26GrTu3xgVW+v1ncGL4wxDP8JchjeE/QwHD/9jGmP/nTpwzZmid13yNIZHhv3gs30/5bJHfUil8v3jLGX5qJCj+n79s/iqGZRuXZuZ15Xx2L3H+r5oo9189Tul/cG7Q/+5JXQd37dulwwAC/9//F1y7fm3QhBkT+qbPnl63b9c+G7gDq6ZWMDNgB4z7DuxjAgDYRF1qpU0MxwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},hydrogen:{src:"/_next/static/media/hydrogen.0bdc0558.png",height:256,width:256,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAA4klEQVR42mOAgcs37sasuvhi89rTj1bduHnbASQWkZrPBJbcc/hk3ILV2/8vPHLl/6wdp/63Tln8f/fRcwZw3TMWrc+KKmj7n5RQ8CMqtex3QnHr/+17D5nBFXz7/1+3e9uB/05z9v61aV33f87RM0/////PAVfw//9/9Zlnb/2Pf/Lrb/KpF/+XXn3w8P///8xwBSfuvQmJaVr2v/PSg9/5p5/8L5i8+cfzT9+14AoWrNpR5RdT9r9k3aX/2bP2/Y9OLP6/98hZF2QrOCZNmr6wpn/ls4q22U/mzVtYDZViBACh5X1ad6PVpwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8}};var d=r(3739);function ResourceList_ResourceList(e){let{resources:t}=e,{width:r}=(0,d.iP)(),i=t.find(e=>e.type===a._.Scrip),o=t.filter(e=>e.type!==a._.Scrip).map(e=>(0,n.createElement)(ResourceList_Resource,{...e,key:e.type}));return(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsxs)("div",{className:"whitespace-nowrap pl-8 text-2xl font-bold",children:["\xa7 ",Math.floor(i.quantity).toLocaleString()]}),(0,s.jsx)("div",{className:"flex h-36 flex-col flex-wrap gap-x-6 gap-y-2 overflow-y-auto pl-6",children:o})]})}function ResourceList_Resource(e){let{type:t,quantity:r,unlocked:i}=e,{width:n}=(0,d.iP)();return(0,s.jsxs)("div",{className:"flex h-9 w-52 justify-between whitespace-nowrap rounded-lg border",children:[(0,s.jsxs)("div",{className:"relative pl-6 text-2xl font-bold",children:[i?(0,s.jsx)(c(),{src:u[t],width:28,height:28,alt:t,className:"absolute -left-3 top-[.125rem] h-[28px] w-[28px]"}):(0,s.jsx)("div",{className:"white-outline absolute -left-2 text-3xl text-slate-500",children:"?"}),Math.floor(r).toLocaleString()]}),r>0&&(0,s.jsx)("button",{className:"mr-[-1px] mt-[-1px] h-9 rounded-lg border px-2 text-slate-500",onClick:()=>{o.o.marketSell(t,r)},children:n<1024?"Sell":"Sell all"})]})}function ResourceListContainer(){let e=(0,i.o)(e=>e.resources);return(0,s.jsx)(ResourceList_ResourceList,{resources:Object.values(e)})}var p=r(5054),g=r(8948),h=r(251),A=r(8960);function Upgrade_Upgrade(e){var t;let{upgrade:r,owned:i,resources:n}=e,{t:a}=(0,h.$G)();if(r.finite&&i>=r.max)return null;let o=r.cost(i),l=!function(e,t){for(let{resource:r,quantity:s}of e)if(t[r].quantity<s)return!1;return!0}(o,n),c=o.map(e=>{let{resource:t,quantity:r}=e;return(0,s.jsxs)("div",{children:[r.toLocaleString()," ",a("resource",{context:t})]},t)}),u="manual"===(t=r.category)?"bg-gradient-to-r from-indigo-800 border-indigo-500":"automatic"===t?"bg-gradient-to-r from-green-800 border-green-500":"bg-gradient-to-r from-blue-800 border-blue-500";return(0,s.jsxs)("button",{className:"border p-1 ".concat(u," hover:brightness-150 active:brightness-100 disabled:brightness-50"),disabled:l,onClick:()=>A.D.buyUpgrade(r),children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"grow text-start text-3xl",children:a("upgrades.".concat(r.type,".name"),{context:i})}),!r.finite&&(0,s.jsxs)("div",{className:"grow text-end",children:["Owned: ",i]})]}),(0,s.jsx)("div",{className:"text-start leading-3",children:a("upgrades.".concat(r.type,".description"))}),(0,s.jsxs)("div",{className:"mt-2 flex gap-2 ".concat(l?"text-red-600":""),children:["Cost: ",c]})]})}function UpgradeList(e){let{resources:t,upgrades:r}=e,i=g.ty.filter(e=>r[e.type].revealed).reverse();return(0,s.jsxs)("div",{className:"flex h-full flex-col overflow-hidden p-2",children:[(0,s.jsx)("h2",{className:"text-5xl",children:"Upgrades"}),(0,s.jsxs)("div",{className:"flex h-full flex-col gap-1 overflow-y-auto",children:[(0,s.jsx)("span",{className:"hidden only:block",children:"No upgrades"}),i.map(e=>(0,s.jsx)(Upgrade_Upgrade,{upgrade:e,owned:r[e.type].owned,resources:t},e.type))]})]})}function UpgradeListContainer(){let e=(0,p.j)(e=>e.upgrades),t=(0,i.o)(e=>e.resources);return(0,s.jsx)(UpgradeList,{upgrades:e,resources:t})}var m=r(1677),f=r(4152),x=r(396),b=r(6613),v=r(1345),j=r(2354),w=r(4432),y=r(6375),S=r(1458),_=r(1722),P=r(5910);function emptySums(){return{[a._.Iron]:0,[a._.Carbon]:0,[a._.Hydrogen]:0,[a._.Copper]:0,[a._.Silicon]:0,[a._.Silver]:0,[a._.Gold]:0,[a._.Platinum]:0,[a._.Uranium]:0,[a._.RedMercury]:0,[a._.Titanium]:0,[a._.Scrip]:0,[a._.Shungite]:0}}function emptyNumbers(){return{[a._.Iron]:[],[a._.Carbon]:[],[a._.Hydrogen]:[],[a._.Copper]:[],[a._.Silicon]:[],[a._.Silver]:[],[a._.Gold]:[],[a._.Platinum]:[],[a._.Uranium]:[],[a._.RedMercury]:[],[a._.Titanium]:[],[a._.Scrip]:[],[a._.Shungite]:[]}}function PopupNumber(e){let{observable:t}=e,[r,i]=(0,n.useState)(emptyNumbers),[a,o]=(0,n.useState)(emptySums),l=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=t.subscribe(e=>{clearTimeout(l.current),i(t=>{let r={...t};for(let[t,s]of e)r[t].push(s);return r}),window.setTimeout(()=>{o(t=>{let r={...t};for(let[t,s]of e)r[t]+=s;return r})},450),l.current=window.setTimeout(()=>{i(emptyNumbers()),o(emptySums())},1800)});return()=>{e.unsubscribe(),clearTimeout(l.current)}},[]),(0,s.jsx)("div",{className:"flex flex-col gap-8",children:Object.entries(r).map(e=>{let[t,r]=e;return 0==r.length&&0==a[t]?null:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(N,{value:a[t],resource:t}),r.map((e,r)=>(0,s.jsx)(UpwardMovingNumber,{value:e,resource:t},r))]},t)})})}function UpwardMovingNumber(e){let{value:t,resource:r}=e,i=(0,_.q_)({from:{y:0},to:{y:-100}});return(0,s.jsx)(P.Zc,{seconds:.45,children:(0,s.jsx)(_.q.div,{style:{width:"min-content",position:"absolute",pointerEvents:"none",...i},children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"m-1 text-4xl font-bold italic",children:(0,s.jsxs)("span",{children:["+",t.toLocaleString()]})}),(0,s.jsx)(c(),{src:u[r],width:50,height:50,alt:r})]})})})}let N=(0,n.memo)(function(e){let{value:t,resource:r}=e,[i,a]=(0,_.q_)(()=>({from:{opacity:0,transform:"scale(1)",y:-100}})),o=(0,n.useRef)(t),l=(0,n.useRef)(null);return((0,n.useEffect)(()=>{clearTimeout(l.current),o.current=t,l.current=window.setTimeout(()=>{a.start({to:{y:-70,opacity:0}})},1e3)},[t]),0==t)?null:(t>0&&a.start({from:{opacity:1,y:-100},to:{opacity:1,y:-100}}),t>o.current&&o.current>0&&a.start({from:{transform:"scale(1)"},to:[{transform:"scale(2)"},{transform:"scale(1)"}],config:{mass:1,friction:50,tension:1e3}}),(0,s.jsx)(_.q.div,{style:{position:"absolute",zIndex:10,pointerEvents:"none",...i},children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("div",{className:"m-1 text-4xl font-bold italic",children:["+",t.toLocaleString()]}),(0,s.jsx)(c(),{src:u[r],width:50,height:50,alt:r})]})}))});function Asteroid_Asteroid(e){let{asteroid:t,onAsteroidClicked:r,...i}=e,[a]=(0,n.useState)(new w.x);return(0,s.jsxs)("group",{...i,dispose:null,children:[(0,s.jsx)(x.V,{children:(0,s.jsx)(PopupNumber,{observable:a})}),t&&(0,s.jsx)(AsteroidWithSpawnTime,{asteroid:t,asteroidClicked:function(){let e=r();a.next(e)}},t.id)]})}function AsteroidWithSpawnTime(e){let t=Date.now(),[r,i]=(0,n.useState)(e.asteroid&&t>=e.asteroid.spawnedAt);t<e.asteroid.spawnedAt&&setTimeout(()=>i(!0),e.asteroid.spawnedAt-t);let a=(0,n.useMemo)(()=>(0,s.jsx)(AsteroidMesh,{asteroidType:e.asteroid.type,onAsteroidClicked:e.asteroidClicked}),[e.asteroid.id]);return r?a:null}function AsteroidMesh(e){let{asteroidType:t,onAsteroidClicked:r}=e;(0,n.useEffect)(()=>()=>{clearTimeout(u.current)});let{nodes:i}=(0,b.L)("/asteroid-transformed.glb"),a=function(e){let t;switch(e){case S.mI.Carbon:t="asteroid-carbon.png";break;case S.mI.Gold:t="asteroid-gold.png";break;default:t="asteroid-iron.png"}let r=(0,j.m)(t);r.repeat.set(2,2),r.magFilter=y.NearestFilter,r.wrapS=y.RepeatWrapping,r.wrapT=y.RepeatWrapping;let s=new y.MeshStandardMaterial({map:r});return s}(t),[o,l]=function(){let[e,t]=(0,f.useSpring)(()=>({from:{scale:1},config:{mass:1,friction:80,tension:2e3}}));return[e,function(){t.start({to:[{scale:.8},{scale:1}]})}]}(),c=(0,n.useRef)(!1),u=(0,n.useRef)();return(0,s.jsx)(f.animated.group,{onPointerDown:()=>{clearTimeout(u.current),c.current=!0,function onPointerDown(){c.current&&(l(),r(),u.current=window.setTimeout(onPointerDown,300))}()},onPointerUp:()=>{clearTimeout(u.current),c.current=!1},onPointerOut:()=>{clearTimeout(u.current),c.current=!1},scale:o.scale,children:(0,s.jsx)(v.b,{floatIntensity:3,rotationIntensity:4,children:(0,s.jsx)(f.animated.mesh,{geometry:i.Asteroid.geometry,material:a})})})}b.L.preload("/asteroid-transformed.glb");var C=r(5887),L=r(5156),R=r(7991);function AsteroidContainer(e){let{index:t,...r}=e,i=(0,m.V)(e=>e.asteroids[t]);return(0,s.jsx)(Asteroid_Asteroid,{asteroid:i,onAsteroidClicked:()=>R.C.clickAsteroid(t),scale:.75,...r})}var D=r(6710);function Moon(e){let{children:t,onClick:r}=e,i=(0,j.m)("asteroid-iron.png");i.repeat.set(4,2),i.magFilter=y.NearestFilter,i.wrapS=y.RepeatWrapping,i.wrapT=y.RepeatWrapping;let a=new y.MeshStandardMaterial({map:i}),[o,l]=(0,n.useState)(!1),c=(0,n.useRef)(null);return(0,D.C)(e=>{let{clock:t}=e;c.current.rotation.y+=.003,c.current.position.x=-2.5*Math.cos(.5*t.getElapsedTime()),c.current.position.z=2.5*Math.sin(.5*t.getElapsedTime())}),(0,n.useEffect)(()=>{document.body.style.cursor=o?"pointer":"auto"},[o]),(0,s.jsxs)("mesh",{ref:c,material:a,onPointerDown:r,onPointerOver:()=>l(!0),onPointerOut:()=>l(!1),position:[2,0,0],children:[(0,s.jsx)("sphereGeometry",{args:[.45,8,8]}),(0,s.jsx)(x.V,{children:t})]})}function Planet(e){let{onClick:t,children:r}=e,i=(0,j.m)("gas-giant-1.png");i.repeat.set(4,2),i.magFilter=y.NearestFilter,i.wrapS=y.RepeatWrapping,i.wrapT=y.RepeatWrapping;let a=new y.MeshStandardMaterial({map:i}),[o,l]=(0,n.useState)(!1),c=(0,n.useRef)(null);return(0,D.C)(()=>{c.current.rotation.y+=.002}),(0,n.useEffect)(()=>{document.body.style.cursor=o?"pointer":"auto"},[o]),(0,s.jsxs)("group",{children:[(0,s.jsx)(x.V,{children:r}),(0,s.jsx)("mesh",{ref:c,material:a,onPointerDown:t,onPointerOver:()=>l(!0),onPointerOut:()=>l(!1),children:(0,s.jsx)("sphereGeometry",{args:[1.5,8,8]})})]})}(0,D.e)({SphereGeometry:y.SphereGeometry}),(0,D.e)({SphereGeometry:y.SphereGeometry});var M=r(9394),z=r(8712);function OutpostDialog(e){let{open:t,onConfirm:r,onCancel:i,details:n}=e,{t:a}=(0,h.$G)();return(0,s.jsxs)(z.fC,{open:t,children:[(0,s.jsx)(z.aV,{className:"fixed inset-0 bg-black opacity-80",onClick:i}),(0,s.jsxs)(z.VY,{className:"absolute left-1/2 top-1/2 w-64 -translate-x-1/2 -translate-y-1/2 rounded-2xl bg-zinc-800 p-4",children:[(0,s.jsx)(z.Dx,{className:"text-3xl",children:"Add outpost"}),(0,s.jsxs)(z.dk,{children:["Do you want to add an outpost to ",a("planets.".concat(n.name)),"? It will cost 1"," ",a(n.outpostType,{count:1}),"."]}),(0,s.jsx)(z.x8,{asChild:!0,children:(0,s.jsx)("button",{className:"absolute right-4 top-4","aria-label":"Close",onClick:i,children:(0,s.jsx)(M.Pxu,{})})}),(0,s.jsxs)("div",{className:"mt-4 flex gap-4",children:[(0,s.jsx)(z.x8,{asChild:!0,children:(0,s.jsx)("button",{className:"grow basis-0 rounded-lg bg-blue-700","aria-label":"Close",onClick:r,children:"Yes"})}),(0,s.jsx)(z.x8,{asChild:!0,children:(0,s.jsx)("button",{className:"grow basis-0 rounded-lg bg-zinc-700","aria-label":"Close",onClick:i,children:"Cancel"})})]})]})]})}var O=r(5494);function ErrorPopover(e){let{open:t,children:r}=e;return(0,s.jsxs)(O.fC,{open:t,children:[(0,s.jsx)(O.ee,{}),(0,s.jsxs)(O.VY,{className:"flex items-center gap-1 rounded-lg bg-zinc-800 p-2 text-red-500",sideOffset:60,side:"top",children:[r,(0,s.jsx)(O.x8,{}),(0,s.jsx)(O.Eh,{className:"fill-zinc-800"})]})]})}var E=r(9711),T=r(6507),k=r(708);function Xileon(e){let{name:t,outposts:r}=e,{onClick:i,observable:n,popupOpen:a}=useClickPlanet(t,r);return(0,s.jsxs)(Planet,{onClick:i,children:[(0,s.jsx)(PopupNumber,{observable:n}),(0,s.jsxs)(ErrorPopover,{open:a,children:[(0,s.jsx)(M.LPM,{}),(0,s.jsx)("span",{children:"Required: Gas Extracting Orbital Station"})]})]})}function Xileon1(e){let{name:t,outposts:r}=e,{onClick:i,observable:n,popupOpen:a}=useClickPlanet(t,r);return(0,s.jsxs)(Moon,{onClick:i,children:[(0,s.jsx)(PopupNumber,{observable:n}),(0,s.jsxs)(ErrorPopover,{open:a,children:[(0,s.jsx)(M.LPM,{}),(0,s.jsx)("span",{children:"Required: Mining Outpost"})]})]})}function OutpostInfo(e){let{name:t,outposts:r,resources:i}=e,{t:a}=(0,h.$G)(),[o,l]=(0,n.useState)(!1),[c,u]=(0,n.useState)(!1),d=(0,n.useRef)(null),g=T.W[t],A=(0,k.r)(e=>e.craftedItems[g.outpostType].quantity),m=(0,p.j)(e=>e.upgrades.outpostCapacity.owned)+1,f=5e3*m;return(0,s.jsxs)("div",{className:"border p-2",children:[(0,s.jsxs)("div",{children:[a("planets.".concat(t))," ",(0,s.jsx)("span",{className:function(e){switch(e){case T.s.GasGiant:return"text-green-700";case T.s.RockyMoon:return"text-zinc-500"}}(g.type),children:a("planetTypes.".concat(g.type))})]}),0===r&&(0,s.jsxs)("div",{children:["Resources: ",Object.keys(g.availableResources).map(e=>a("resource",{context:e}))]}),(0,s.jsxs)("div",{className:"".concat(0===r?"text-red-700":""),children:["Outposts: ",r," (max: ",g.maxOutposts,")"]}),r<g.maxOutposts&&(0,s.jsx)("div",{children:(0,s.jsx)("button",{className:"w-full rounded-lg ".concat(A>0?"bg-blue-700":"bg-zinc-700"),onClick:()=>{if(A<1){clearTimeout(d.current),u(!0),d.current=setTimeout(()=>u(!1),2e3);return}l(!0)},children:"Add Outpost"})}),r>0&&(0,s.jsx)("div",{children:"Ready to collect:"}),Object.entries(i).map(e=>{let[t,r]=e;return r<1?null:(0,s.jsxs)("span",{className:"tabular-nums",children:[a("resource",{context:t}),": ",Math.floor(r)," ",r>=f?"(full)":""]},t)}),(0,s.jsxs)(ErrorPopover,{open:c,children:[(0,s.jsx)(M.LPM,{}),(0,s.jsxs)("span",{children:["Not enough ",a(g.outpostType,{count:2})]})]}),(0,s.jsx)(OutpostDialog,{open:o,onConfirm:()=>{l(!1),E._.addOutpost(t)},onCancel:()=>l(!1),details:{name:t,outpostType:g.outpostType}})]})}function useClickPlanet(e,t){let[r,s]=(0,n.useState)(!1),[i]=(0,n.useState)(new w.x),a=(0,n.useRef)(null),o=(0,n.useRef)(0);return{onClick:function(r){r.stopPropagation();let n=Date.now();if(n-o.current<1e3)return;if(o.current=n,0===t){clearTimeout(a.current),s(!0),a.current=setTimeout(()=>s(!1),2e3);return}let l=E._.collectResourcesFromOutpost(e);i.next(l.map(e=>{let[t,r]=e;return[t,Math.floor(r)]}))},observable:i,popupOpen:r}}function Stage(){let[e,t]=(0,n.useState)("asteroidField"),{t:r}=(0,h.$G)(),i=U[e];return(0,s.jsxs)("div",{className:"flex h-full flex-col",children:[(0,s.jsxs)("div",{className:"flex basis-[content] gap-2 p-2",children:[(0,s.jsx)("span",{className:"inline-flex items-center",children:"Current sector: "}),(0,s.jsx)("select",{className:"rounded-lg bg-zinc-800 px-2 py-1 text-center",onChange:e=>t(e.target.value),children:Object.keys(U).map(e=>(0,s.jsx)("option",{value:e,children:r("sectors.".concat(e))},e))})]}),(0,s.jsx)(i,{})]})}let U={asteroidField:function(){return(0,s.jsx)("div",{className:"aspect-square max-h-[70vh]",children:(0,s.jsxs)(C.Xz,{children:[(0,s.jsx)(AsteroidContainer,{index:0,scale:.75,position:[0,1.7,0]}),(0,s.jsx)(AsteroidContainer,{index:1,scale:.75,position:[1.5,1,0]}),(0,s.jsx)(AsteroidContainer,{index:2,scale:.75,position:[1.8,-1,0]}),(0,s.jsx)(AsteroidContainer,{index:3,scale:.75,position:[-1,-1.8,0]}),(0,s.jsx)(AsteroidContainer,{index:4,scale:.75,position:[-.1,-.1,0]}),(0,s.jsx)(AsteroidContainer,{index:5,scale:.75,position:[-1.5,1,0]}),(0,s.jsx)(L.Common,{})]})})},xileon:function(){let e=(0,m.V)(e=>e.planets.xileon),t=(0,m.V)(e=>e.planets.xileon1);return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"aspect-square max-h-[70vh]",children:(0,s.jsxs)(C.Xz,{children:[(0,s.jsx)(Xileon,{name:"xileon",...e}),(0,s.jsx)(Xileon1,{name:"xileon1",...t}),(0,s.jsx)(L.Common,{})]})}),(0,s.jsxs)("div",{className:"flex gap-4 p-2",children:[(0,s.jsx)(OutpostInfo,{name:"xileon",...e}),(0,s.jsx)(OutpostInfo,{name:"xileon1",...t})]})]})}};function Page(){return(0,s.jsxs)("div",{id:"main-page",children:[(0,s.jsx)("div",{id:"stage",children:(0,s.jsx)(Stage,{})}),(0,s.jsx)("div",{id:"resource-list",children:(0,s.jsx)(ResourceListContainer,{})}),(0,s.jsx)("div",{id:"upgrade-list",children:(0,s.jsx)(UpgradeListContainer,{})})]})}r(5053)},1568:function(e,t,r){"use strict";r.d(t,{ZA:function(){return i},hM:function(){return n},rs:function(){return o},s7:function(){return a}});var s=r(4249);let i=1094219,n=14289161,a=2763306,o={[s._.Iron]:25,[s._.Carbon]:50,[s._.Gold]:100,[s._.Silicon]:200,[s._.Hydrogen]:350,[s._.Platinum]:0,[s._.Uranium]:0,[s._.Shungite]:0,[s._.Silver]:0,[s._.Copper]:0,[s._.RedMercury]:0,[s._.Titanium]:0,[s._.Scrip]:0}},9954:function(e,t,r){"use strict";function calcPrice(e,t,r){return e+=r(t/35e6,1)*(.8*e),e+=r(t/35e5,1)*(.5*e),e+=r(t/1e5,1)*(.3*e),e+=r(t/1e4,1)*(.2*e),e+=r(t/1e3,1)*(.1*e),Math.round(100*(e+=r(t/100,1)*(.03*e))+Number.EPSILON)/100}r.d(t,{l:function(){return calcPrice}})},5156:function(e,t,r){"use strict";r.r(t),r.d(t,{Common:function(){return Common},View:function(){return l}});var s=r(7437),i=r(2265),n=r(1371),a=r(6701),o=r(9904);let Three=e=>{let{children:t}=e;return(0,s.jsx)(o.v.In,{children:t})},Common=e=>{let{color:t}=e;return(0,s.jsxs)(i.Suspense,{fallback:null,children:[t&&(0,s.jsx)("color",{attach:"background",args:[t]}),(0,s.jsx)("ambientLight",{intensity:.1}),(0,s.jsx)("directionalLight",{position:[1,1,1],intensity:.5})]})},l=(0,i.forwardRef)((e,t)=>{let{children:r,orbit:o,...l}=e,c=(0,i.useRef)(null);return(0,i.useImperativeHandle)(t,()=>c.current),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{ref:c,...l}),(0,s.jsx)(Three,{children:(0,s.jsxs)(n.G,{track:c,children:[r,o&&(0,s.jsx)(a.z,{})]})})]})});l.displayName="View"},9904:function(e,t,r){"use strict";r.d(t,{v:function(){return i}});var s=r(9078);let i=(0,s.Z)()},5540:function(e,t,r){"use strict";r.d(t,{HH:function(){return MarketOrder},eN:function(){return LimitOrder}});var s=r(7180),i=r(4249);let BaseOrder=class BaseOrder{validate(){throw Error("Method not implemented.")}cancel(){this.status="cancelled";let e="sell"===this.side?this.resource:i._.Scrip;s.o.getState().increase([[e,this.size-this.filled]])}fill(e,t){if("open"!==this.status)throw Error("Order is not open");if(e>this.size-this.filled)throw Error("Fill size is too large");this.filled+=e,this.executedPrice=t,this.filled>=this.size&&(this.status="filled")}get percentFilled(){return this.filled/this.size}constructor(e,t,r,s=Date.now()){this.id=crypto.randomUUID(),this.side=e,this.resource=t,this.size=r,this.time=s,this.filled=0,this.status="open"}};let MarketOrder=class MarketOrder extends BaseOrder{validate(){if(this.size<1)return!1;let e="sell"===this.side?this.resource:i._.Scrip;return s.o.getState().resources[e].quantity>=this.size}static from(e){let t=new MarketOrder(e.side,e.resource,e.size,e.time);return t.id=e.id,t.filled=e.filled,t.status=e.status,t.executedPrice=e.executedPrice,t}constructor(e,t,r,s=Date.now()){super(e,t,r,s),this.type="market"}};let LimitOrder=class LimitOrder extends BaseOrder{validate(){return!(this.size<1)&&("sell"===this.side?s.o.getState().resources[this.resource].quantity>=this.size:s.o.getState().resources[i._.Scrip].quantity>=this.size*this.price)}static from(e){let t=new LimitOrder(e.side,e.resource,e.size,e.price,e.time);return t.id=e.id,t.filled=e.filled,t.status=e.status,t.executedPrice=e.executedPrice,t}constructor(e,t,r,s,i=Date.now()){super(e,t,r,i),this.type="limit",this.price=s}}},6507:function(e,t,r){"use strict";r.d(t,{W:function(){return a},s:function(){return i}});var s,i,n=r(9453);(s=i||(i={})).GasGiant="gasGiant",s.RockyMoon="rockyMoon";let a={xileon:{name:"xileon",type:"gasGiant",outpostType:n.KE.GasExtractingOrbitalStation,availableResources:{hydrogen:1},maxOutposts:1},xileon1:{name:"xileon1",type:"rockyMoon",outpostType:n.KE.MiningOutpost,availableResources:{silicon:1},maxOutposts:1}}},7991:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var s=r(1458),i=r(4249),n=r(1677),a=r(7180),o=r(5054);let l=new class{clickAsteroid(e){let t=n.V.getState().asteroids[e];if(!t)return;let r=1+o.j.getState().upgrades.asteroidClickStrength.owned,s=1+o.j.getState().upgrades.asteroidDurability.owned,i=this.calculateResourcesForAsteroid(t,Math.min(t.durability*s,r));a.o.getState().increase(i);let l=t.durability-r/s<=0;return l?(n.V.getState().remove(t),this.spawnAsteroid(Date.now()+3e3)):n.V.getState().modify({...t,durability:t.durability-r/s}),i}checkIfAsteroidShouldSpawn(){let e=Object.keys(n.V.getState().asteroids).length,t=o.j.getState().upgrades.asteroidAttractor.owned;e<t+1&&this.spawnAsteroid()}spawnAsteroid(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();n.V.getState().add(new s.lh({type:this.pickRandomAsteroidType(),spawnedAt:e}))}pickRandomAsteroidType(){return o.j.getState().upgrades.goldExtraction.owned>0&&Math.random()>.9?s.mI.Gold:o.j.getState().upgrades.carbonExtraction.owned>0&&Math.random()>.7?s.mI.Carbon:s.mI.Iron}calculateResourcesForAsteroid(e,t){let r=[],n=o.j.getState().upgrades.ironClickEfficiency.owned;if(r.push([i._.Iron,(1+n)*t]),o.j.getState().upgrades.carbonExtraction.owned>0){let n=o.j.getState().upgrades.carbonClickEfficiency.owned,a=Math.random()*(1.3+n);e.type===s.mI.Carbon&&(a+=2*(1+n)),(a=Math.floor(a*t))&&r.push([i._.Carbon,a])}if(o.j.getState().upgrades.goldExtraction.owned>0){let n=o.j.getState().upgrades.goldClickEfficiency.owned,a=Math.random()*(1.1+n);e.type===s.mI.Gold&&(a+=2*(1+n)),(a=Math.floor(a*t))&&r.push([i._.Gold,a])}return r}}},9711:function(e,t,r){"use strict";r.d(t,{_:function(){return l}});var s=r(6507),i=r(708),n=r(1677),a=r(7180),o=r(5054);let l=new class{addOutpost(e){let t=s.W[e].outpostType;i.r.getState().craftedItems[t].quantity<1||(i.r.getState().decrease(t,1),n.V.getState().addOutpost(e))}updateResourcesInMiningOutposts(e){let t=n.V.getState().planets,r=o.j.getState().upgrades.outpostEfficiency.owned+1,i=o.j.getState().upgrades.outpostCapacity.owned+1,a=5e3*i;for(let i of Object.values(s.W)){let s=t[i.name].outposts;if(s>0){let o=e/1e3*s,l=Object.entries(i.availableResources).reduce((e,s)=>{var n;let[l,c]=s,u=null!==(n=t[i.name].resources[l])&&void 0!==n?n:0,d=a-u;return e[l]=Math.min(o*c*r,d),e},{});n.V.getState().addResourcesToOutpost(i.name,l)}}}collectResourcesFromOutpost(e){let t=n.V.getState().planets[e].resources;n.V.getState().removeResourcesFromOutpost(e);let r=Object.entries(t);return a.o.getState().increase(r),r}}},7162:function(e,t,r){"use strict";r.d(t,{o:function(){return A}});var s=r(4846),i=r.n(s),n=r(4432),a=r(4185),o=r.n(a),l=r(7973),c=r(1568),u=r(9954),d=r(5540),p=r(4249),g=r(4273),h=r(7180);let A=new class{marketSell(e,t){if(e===p._.Scrip)return;t=Math.floor(t);let r=new d.HH("sell",e,t);if(!r.validate())return;let s=this.getPrice(e);h.o.getState().decrease(e,t),h.o.getState().increase([[p._.Scrip,t*s]]),r.fill(t,s),g.L.getState().add(r)}limitSell(e,t,r){if(e===p._.Scrip)return;(t=Math.floor(t))>Number.MAX_SAFE_INTEGER&&console.warn("too much");let s=new d.eN("sell",e,t,r);if(!s.validate())return;let i=this.getPrice(e);h.o.getState().decrease(e,t),r>i?(g.L.getState().add(s),this._openLimitOrders[e].push(s)):(h.o.getState().increase([[p._.Scrip,t*i]]),s.fill(t,i),g.L.getState().add(s))}marketBuy(e,t){if(e===p._.Scrip)return;t=Math.floor(t);let r=new d.HH("buy",e,t);if(!r.validate())return;let s=this.getPrice(e);h.o.getState().decrease(p._.Scrip,t);let i=t/s;h.o.getState().increase([[e,i]]),r.fill(t,s),g.L.getState().add(r)}limitBuy(e,t,r){if(e===p._.Scrip)return;(t=Math.floor(t))>Number.MAX_SAFE_INTEGER&&console.warn("too much");let s=new d.eN("buy",e,t,r);if(!s.validate())return;let i=this.getPrice(e);r>i?(h.o.getState().decrease(p._.Scrip,t*i),h.o.getState().increase([[e,t]]),s.fill(t,i),g.L.getState().add(s)):(h.o.getState().decrease(p._.Scrip,t*r),g.L.getState().add(s),this._openLimitOrders[e].push(s))}cancelOrder(e){let t=g.L.getState().orders.find(t=>t.id===e);t&&(t.cancel(),g.L.getState().update(t))}get observable(){return this._observable}getPrice(e){let t;switch(e){case p._.Iron:t=this._iron;break;case p._.Carbon:t=this._carbon;break;case p._.Gold:t=this._gold;break;case p._.Silicon:t=this._silicon;break;case p._.Hydrogen:t=this._hydrogen;break;default:return 0}return(0,u.l)(c.rs[e],Date.now()/1e3,t)}generateFakeTrade(){let e=i()(Object.values(p._));if(void 0===e||e===p._.Scrip)return;let t=this.getPrice(e);this._observable.next({resource:e,price:t});let r=this._openLimitOrders[e];if(0===r.length)return;let s=[];for(let i of r)"buy"===i.side?i.price>=t?(h.o.getState().increase([[e,i.size]]),i.fill(i.size,t),g.L.getState().update(i)):s.push(i):i.price<=t?(h.o.getState().increase([[p._.Scrip,i.size*i.price]]),i.fill(i.size,t),g.L.getState().update(i)):s.push(i);this._openLimitOrders[e]=s}constructor(){this._observable=new n.x,this._iron=(0,l.hA)(o()(p._.Iron)),this._carbon=(0,l.hA)(o()(p._.Carbon)),this._gold=(0,l.hA)(o()(p._.Gold)),this._silicon=(0,l.hA)(o()(p._.Silicon)),this._hydrogen=(0,l.hA)(o()(p._.Hydrogen)),this._openLimitOrders={[p._.Scrip]:[],[p._.Iron]:[],[p._.Carbon]:[],[p._.Copper]:[],[p._.Gold]:[],[p._.Platinum]:[],[p._.RedMercury]:[],[p._.Shungite]:[],[p._.Silicon]:[],[p._.Silver]:[],[p._.Titanium]:[],[p._.Uranium]:[],[p._.Hydrogen]:[]},function loop(e){setTimeout(()=>{A.generateFakeTrade(),loop(1e3*Math.random())},e)}(1)}}},8960:function(e,t,r){"use strict";r.d(t,{D:function(){return a}});var s=r(7180),i=r(5054),n=r(7991);let a=new class{buyUpgrade(e){for(let t of e.cost(i.j.getState().upgrades[e.type].owned))s.o.getState().decrease(t.resource,t.quantity);i.j.getState().increase(e.type),"asteroidAttractor"===e.type&&n.C.spawnAsteroid()}checkForRevealedUpgrades(){let e=s.o.getState().resources,t=i.j.getState().upgrades,r=i.j.getState().upgradeRevealConditions;for(let s of Object.keys(r))r[s](e,t)&&(i.j.getState().reveal(s),delete r[s])}}},5053:function(){},393:function(){}},function(e){e.O(0,[689,310,776,714,251,396,650,613,570,880,887,25,273,971,184,744],function(){return e(e.s=6570)}),_N_E=e.O()}]);