(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[565],{5722:function(e,t,i){Promise.resolve().then(i.bind(i,5263))},5263:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return Page}});var s,a,r=i(7437),n=i(2265);(s=a||(a={}))[s["1m"]=1]="1m",s[s["5m"]=5]="5m",s[s["15m"]=15]="15m",s[s["1h"]=60]="1h",s[s["4h"]=240]="4h",s[s["1d"]=1440]="1d";var l=i(3230);let o=["1m","5m","15m","1h","4h","1d"];var h=i(1568);let ChartCursor=class ChartCursor{draw(e,t,i,s,a){this.cursorGraphics.clear();let r=this.pixiApplication.view.width-140;if(e<0||e>r||t>this.pixiApplication.view.height-60*window.devicePixelRatio||t<10*window.devicePixelRatio){this.priceContainer.visible=!1,this.dateContainer.visible=!1,this.setHighlightedCandle(void 0);return}this.priceContainer.visible=!0,this.dateContainer.visible=!0;let n="line"===this.style?e-e%i:e-e%i+i/2;this.cursorGraphics.lineStyle(2,16777215);let l=10*window.devicePixelRatio;this.cursorGraphics.moveTo(n,l);for(let e=0;e<(this.pixiApplication.view.height-l-60)/8;e++)this.cursorGraphics.lineTo(n,l+8*e),this.cursorGraphics.moveTo(n,l+8*e+4);this.cursorGraphics.moveTo(0,t);for(let e=0;e<r/8;e++)this.cursorGraphics.lineTo(8*e,t),this.cursorGraphics.moveTo(8*e+4,t);let o=s[s.length-1]-s[0],h=1/o*(this.pixiApplication.view.height-10*window.devicePixelRatio-60*window.devicePixelRatio),c=s[s.length-1]-(t-10*window.devicePixelRatio)/h;if(this.priceText.text=c.toFixed(2),this.priceContainer.x=this.pixiApplication.view.width-140,this.priceContainer.y=t,this.setHighlightedCandle(a),!a)return;let d=new Date(a[0]);this.dateText.text=d.toLocaleString(),this.dateTextBackground.width=this.dateText.width+16,this.dateTextBackground.height=this.dateText.height+10,this.dateContainer.x=e-e%i+i/2,this.dateContainer.y=this.pixiApplication.view.height-60}constructor(e,t,i){this.cursorLabelsContainer=new l.W20,this.cursorGraphics=new l.TCu,this.priceContainer=new l.W20,this.dateContainer=new l.W20,this.priceText=new l.xvT("",{fill:"white",fontSize:32}),this.dateText=new l.xvT("",{fill:"white",fontSize:32}),this.dateTextBackground=new l.jyi(l.xEZ.WHITE),this.pixiApplication=e,this.style=t,this.setHighlightedCandle=i,this.pixiApplication.stage.addChild(this.cursorLabelsContainer),this.pixiApplication.stage.addChild(this.cursorGraphics),this.priceText.x=10,this.priceText.anchor.set(0,.5);let s=new l.jyi(l.xEZ.WHITE);s.tint=h.s7,s.width=140*window.devicePixelRatio,s.height=this.priceText.height+14,s.anchor.set(0,.5),this.priceContainer.addChild(s,this.priceText),this.priceContainer.visible=!1,this.dateText.anchor.set(.5,.5),this.dateTextBackground.anchor.set(.5,.5),this.dateTextBackground.tint=h.s7,this.dateContainer.addChild(this.dateTextBackground,this.dateText),this.dateContainer.visible=!1,this.cursorLabelsContainer.addChild(this.priceContainer,this.dateContainer),this.draw=this.draw.bind(this)}};let LastPriceIndicator=class LastPriceIndicator{drawLastPriceIndicator(e,t){let i=e[e.length-1],s=e[0],a=(i-t)/(i-s)*(this.pixiApplication.view.height-10*window.devicePixelRatio-60*window.devicePixelRatio)+10*window.devicePixelRatio;this.lastPriceLineGraphics.clear(),this.lastPriceLineGraphics.lineStyle(2,h.ZA),this.lastPriceLineGraphics.moveTo(0,a);let r=this.pixiApplication.view.width-140;for(let e=0;e<r/8;e++)this.lastPriceLineGraphics.lineTo(8*e,a),this.lastPriceLineGraphics.moveTo(8*e+4,a);this.lastPriceText.text=t.toFixed(2),this.lastPriceTextContainer.x=this.pixiApplication.view.width-140,this.lastPriceTextContainer.y=a}constructor(e){this.lastPriceTextContainer=new l.W20,this.lastTradePriceLabelContainer=new l.W20,this.lastPriceLineGraphics=new l.TCu,this.lastPriceText=new l.xvT("",{fill:"white",fontSize:32}),this.pixiApplication=e,this.pixiApplication.stage.addChild(this.lastTradePriceLabelContainer),this.pixiApplication.stage.addChild(this.lastPriceLineGraphics),this.lastPriceText.x=10,this.lastPriceText.anchor.set(0,.5);let t=new l.jyi(l.xEZ.WHITE);t.tint=h.ZA,t.width=140*window.devicePixelRatio,t.height=this.lastPriceText.height+14,t.anchor.set(0,.5),this.lastPriceTextContainer.addChild(t,this.lastPriceText),this.lastPriceTextContainer.x=-100,this.lastPriceTextContainer.y=-100,this.lastTradePriceLabelContainer.addChild(this.lastPriceTextContainer)}};let Dragging=class Dragging{onDragStart(e){let t=e.offsetX*window.devicePixelRatio;this.startDragOffset=t-t%(30+this.chart.zoom),this.lastDragOffset=t}onDragEnd(e){this.candleOffset+=Math.floor(this.draggingOffset),this.draggingOffset=0,this.startDragOffset=0,this.lastDragOffset=0}onDragMove(e){if(!this.startDragOffset||this.chart.pinching)return;let t=e.offsetX*window.devicePixelRatio,i=t<this.lastDragOffset;this.lastDragOffset=t;let s=t-t%(30+this.chart.zoom)-this.startDragOffset,a=s/(30+this.chart.zoom),r=Math.max(this.chart.zoom*(30/(this.chart.zoom+30)),-5),n=a+this.candleOffset+r<-5;if(this.pixiApplication.view.width,this.chart.zoom,n&&i){let e=t+(30+this.chart.zoom)*(5+this.candleOffset);this.startDragOffset=e;return}this.draggingOffset=a;let l=Math.floor(this.draggingOffset+this.candleOffset);l!==this.chart.totalOffset&&(this.chart.totalOffset=l,this.chart.draw())}cleanup(){this.container.removeEventListener("pointerdown",this.onDragStart),this.container.removeEventListener("pointerup",this.onDragEnd),this.container.removeEventListener("pointerleave",this.onDragEnd),this.container.removeEventListener("pointermove",this.onDragMove)}constructor(e,t,i){this.startDragOffset=0,this.lastDragOffset=0,this.candleOffset=0,this.draggingOffset=0,this.pixiApplication=e,this.chart=t,this.container=i,this.onDragStart=this.onDragStart.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDragMove=this.onDragMove.bind(this),i.addEventListener("pointerdown",this.onDragStart),i.addEventListener("pointerup",this.onDragEnd),i.addEventListener("pointerleave",this.onDragEnd),i.addEventListener("pointermove",this.onDragMove)}};let ChartZooming=class ChartZooming{onScroll(e){let t=e.deltaY;t>0?this.chart.zoom>-20&&(this.chart.zoom-=5):this.chart.zoom<80&&(this.chart.zoom+=5),this.chart.draw()}onTouchMove(e){let{targetTouches:t}=e;if(t.length<2)return;let i=t[0].clientX,s=t[1].clientX,a=t[0].clientY,r=t[1].clientY,n=Math.sqrt(Math.pow(i-s,2)+Math.pow(a-r,2));null===this.startingDistance&&(this.startingDistance=n);let l=n/this.startingDistance;Math.abs(l-this.chart.pinch)>.1&&(this.chart.pinch=l,this.chart.draw())}onTouchEnd(e){e.targetTouches.length<2&&(this.chart.zoom+=(30+this.chart.zoom)*this.chart.pinch-(30+this.chart.zoom),this.chart.pinch=1,this.chart.pinching=!1,this.startingDistance=null)}onTouchStart(e){e.targetTouches.length>1&&(this.chart.pinching=!0)}cleanup(){this.container.removeEventListener("wheel",this.onScroll),this.container.removeEventListener("touchstart",this.onTouchStart),this.container.removeEventListener("touchmove",this.onTouchMove),this.container.removeEventListener("touchend",this.onTouchEnd)}constructor(e,t){this.startingDistance=null,this.container=t,this.chart=e,this.onScroll=this.onScroll.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),t.addEventListener("wheel",this.onScroll),t.addEventListener("touchstart",this.onTouchStart),t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("touchend",this.onTouchEnd)}};var c=i(7162);let ChartLabels=class ChartLabels{setupChartLabels(){for(let e=0;e<12;e++){let e=new l.xvT("",{fill:"white",fontSize:32});e.anchor.set(0,.5),e.x=0,e.y=-100,this.labelsContainer.addChild(e),this.yAxisLabels.push(e)}for(let e=0;e<6;e++){let e=new l.xvT("",{fill:"white",fontSize:32});e.anchor.set(.5,.5),e.x=0,e.y=-100,this.datetimeLabelsContainer.addChild(e),this.datetimeLabels.push(e)}}draw(e,t){this.drawYAxisLabels(e),this.drawDateTimeLabels(t)}drawYAxisLabels(e){let t=e[e.length-1],i=e[0],s=t-i;for(let i=0;i<e.length;i++){let a=e[i],r=(t-a)/s*(this.pixiApplication.view.height-10*window.devicePixelRatio-60*window.devicePixelRatio)+10*window.devicePixelRatio,n=this.yAxisLabels[i];n.text=a,n.x=this.pixiApplication.view.width-140+10,n.y=r}for(let t=e.length;t<this.yAxisLabels.length;t++)this.yAxisLabels[t].y=-100}drawDateTimeLabels(e){let t=Math.floor(this.pixiApplication.view.width/300),i=e[e.length-1][0]-e[0][0],s=this.closestInterval(i/6e4/t),a=(30+this.chart.zoom)*this.chart.pinch,r=0;for(let[t,i]of e.entries()){let e;if(s>5760){if(!this.isStartOfMonth(i[0]))continue}else if(s>2880){if(!this.isQuarterOfMonth(i[0]))continue}else{let e=new Date(i[0]).getTimezoneOffset();if((i[0]/6e4-e)%s!=0)continue}let n=new Date(i[0]),o=new Date(i[0]-6e4*s);e=n.getFullYear()!==o.getFullYear()?n.getFullYear():n.getMonth()!==o.getMonth()?n.toLocaleString(void 0,{month:"short"}):n.getDate()!==o.getDate()?n.getDate():n.toLocaleString(void 0,{hourCycle:"h23",timeStyle:"short"});let h=this.datetimeLabels[r];h||((h=new l.xvT("",{fill:"white",fontSize:32})).anchor.set(.5,.5),this.datetimeLabels.push(h),this.datetimeLabelsContainer.addChild(h)),h.text=e,h.x=t*a+a/2,h.y=this.pixiApplication.view.height-60,r++}for(;r<this.datetimeLabels.length;r++)this.datetimeLabels[r].y=-100}closestInterval(e){let t=1,i=1/0;for(let s of ChartLabels.niceMinutes){let a=Math.abs(e-s);if(a<i)t=s,i=a;else break}return t}isStartOfMonth(e){let t=new Date(e).getTimezoneOffset(),i=new Date(e+6e4*t);return i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),e===i.setDate(1)}isQuarterOfMonth(e){let t=new Date(e).getTimezoneOffset(),i=new Date(e+6e4*t);return i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),e===i.setDate(1)||e===i.setDate(8)||e===i.setDate(15)||e===i.setDate(22)}constructor(e,t){this.labelsContainer=new l.W20,this.datetimeLabelsContainer=new l.W20,this.yAxisLabels=[],this.datetimeLabels=[],this.pixiApplication=e,this.chart=t,e.stage.addChild(this.labelsContainer),e.stage.addChild(this.datetimeLabelsContainer),this.setupChartLabels()}};ChartLabels.niceMinutes=[1,5,10,15,20,30,60,120,180,240,360,720,1440,2880,5760,11520,23040,43200];let ChartGridLines=class ChartGridLines{draw(e){let t=e[e.length-1],i=e[0],s=t-i;for(let i of(this.gridLinesGraphics.clear(),this.gridLinesGraphics.lineStyle(2,2763306),e)){let e=(t-i)/s*(this.pixiApplication.view.height-10*window.devicePixelRatio-60*window.devicePixelRatio)+10*window.devicePixelRatio;this.gridLinesGraphics.moveTo(0,e),this.gridLinesGraphics.lineTo(this.pixiApplication.view.width-140,e)}}constructor(e){this.gridLinesGraphics=new l.TCu,this.pixiApplication=e,this.pixiApplication.stage.addChild(this.gridLinesGraphics)}};let ChartDataDisplay=class ChartDataDisplay{draw(e,t){"line"===this.style?this.drawLines(t,e):this.drawCandles(t,e)}drawCandles(e,t){this.candlesGraphics.clear(),e.map((e,i)=>{let s,a,r;let[n,l,o,c,d]=e,u=t[t.length-1],p=t[0],g=u-p,x=1/g*(this.pixiApplication.view.height-10*window.devicePixelRatio-60*window.devicePixelRatio);l>d?(s=(u-l)*x+10*window.devicePixelRatio,a=(l-d)*x,r=h.hM):(s=(u-d)*x+10*window.devicePixelRatio,a=Math.max((d-l)*x,1),r=h.ZA);let f=(30+this.chart.zoom)*this.chart.pinch,m=i*f,w=m+f/2;this.candlesGraphics.beginFill(r),this.candlesGraphics.lineStyle(0),this.candlesGraphics.drawRect(m+4,s,f-4,a),this.candlesGraphics.endFill(),this.candlesGraphics.lineStyle(1,r),this.candlesGraphics.moveTo(w,(u-o)*x+10*window.devicePixelRatio),this.candlesGraphics.lineTo(w,s),this.candlesGraphics.moveTo(w,s+a),this.candlesGraphics.lineTo(w,(u-c)*x+10*window.devicePixelRatio)})}drawLines(e,t){let i=t[t.length-1],s=t[0],a=i-s,r=1/a*(this.pixiApplication.view.height-10*window.devicePixelRatio-60*window.devicePixelRatio),n=e[0][4]>e[e.length-1][4]?h.hM:h.ZA;this.candlesGraphics.clear(),this.candlesGraphics.lineStyle(2,n),this.candlesGraphics.moveTo(0,(i-e[0][4])*r+10*window.devicePixelRatio);for(let t=1;t<e.length;t++)this.candlesGraphics.lineTo(t*((30+this.chart.zoom)*this.chart.pinch),(i-e[t][4])*r+10*window.devicePixelRatio)}constructor(e,t,i){this.candlesGraphics=new l.TCu,this.pixiApplication=e,this.chart=t,this.style=i,this.pixiApplication.stage.addChild(this.candlesGraphics)}};var d=i(9954),u=i(7973),p=i(4185),g=i.n(p);let Chart=class Chart{draw(){let e=this.candlesInView(),t=this.generateYAxisValues();this.chartGridLines.draw(t),this.chartDataDisplay.draw(t,e),this.chartLabels.draw(t,e),this.lastPriceIndicator.drawLastPriceIndicator(t,this.data[this.data.length-1][4])}cleanup(){window.removeEventListener("resize",this.onResize),this.container.removeEventListener("pointermove",this.onPointerMove),this.subscription.unsubscribe(),clearInterval(this.intervalId),this.chartDragging.cleanup(),this.chartZooming.cleanup(),this.pixiApplication.destroy(),this.container.innerHTML=""}fetchData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new Date(this.data[0]?this.data[0][0]:Date.now());t.setMinutes(t.getMinutes()-this.interval);let i=t.valueOf();t.setMinutes(t.getMinutes()-300*this.interval);let s=t.valueOf(),a=this.generateCandles(this.generateTimestamps(s,i,this.interval),h.rs[this.market],this.market,e?i:void 0);this.data.unshift(...a)}onResize(){this.pixiApplication.resize(),this.draw()}onPointerMove(e){let t=e.offsetX*window.devicePixelRatio,i=e.offsetY*window.devicePixelRatio,s=30+this.zoom,a=this.numberOfCandlesInView(),r=Math.floor(t/s),n=this.data[this.data.length-this.totalOffset-a+r],l=this.generateYAxisValues();this.cursor.draw(t,i,s,l,n)}numberOfCandlesInView(){return Math.floor((this.pixiApplication.view.width-140)/(30+this.zoom))}candlesInView(){let e=this.numberOfCandlesInView();return this.totalOffset+e>this.data.length&&(this.totalOffset=this.data.length-e),this.data.length-(this.totalOffset+e)<100&&this.fetchData(),this.data.slice(this.data.length-this.totalOffset-e,this.data.length-this.totalOffset)}generateYAxisValues(){let e=this.candlesInView(),t=Math.max.apply(Math,e.map(e=>e[2])),i=Math.min.apply(Math,e.map(e=>e[3])),s=t-i;if(s<1||isNaN(s))return[];let a=s/9,r=Math.ceil(Math.log10(a)-1),n=Math.pow(10,r),l=Math.max(1,Math.ceil(a/n)*n),o=l*Math.floor(i/l),h=l*Math.ceil(t/l),c=[],d=o;for(;c.push(d),!((d+=l)>h););return c}generateCandles(e,t,i,s){let a=(0,u.hA)(g()(i)),r=[];for(let i=0;i<e.length;i++){let n=e[i],l=i===e.length-1?null!=s?s:n+e[1]-e[0]:e[i+1]-1,o=(0,d.l)(t,n/1e3,a),h=(0,d.l)(t,l/1e3,a),c=(0,d.l)(t,(n+(n-l)*.33)/1e3,a),u=(0,d.l)(t,(n+(n-l)*.66)/1e3,a),p=Math.max(o,h,c,u),g=Math.min(o,h,c,u);r.push([n,o,p,g,h,0])}return r}generateTimestamps(e,t,i){let s=new Date(this.getBeginningOfInterval(e,i)),a=new Date(t),r=[];for(;s<=a;)r.push(s.getTime()),s.setMinutes(s.getMinutes()+i);return r}getBeginningOfInterval(e,t){let i=new Date(e);switch(t){case a["1m"]:i.setSeconds(0);break;case a["5m"]:i.setSeconds(0),i.setMinutes(i.getMinutes()-i.getMinutes()%5);break;case a["15m"]:i.setSeconds(0),i.setMinutes(i.getMinutes()-i.getMinutes()%15);break;case a["1h"]:i.setSeconds(0),i.setMinutes(0);break;case a["4h"]:i.setSeconds(0),i.setMinutes(0),i.setHours(i.getHours()-i.getHours()%4);break;case a["1d"]:i.setSeconds(0),i.setMinutes(0),i.setHours(0)}return i.setMilliseconds(0),i}constructor(e,t,i,s,a){this.totalOffset=0,this.zoom=0,this.pinch=1,this.pinching=!1,this.data=[],l.Xdb.RESOLUTION=window.devicePixelRatio,this.pixiApplication=new l.MxU({backgroundColor:657930,antialias:!0,autoDensity:!0,width:100,height:100}),this.container=e,this.interval=s,this.market=i,this.pixiApplication.resizeTo=e,this.container.appendChild(this.pixiApplication.view),this.pixiApplication.stage.interactive=!0,this.pixiApplication.stage.scale.set(1/window.devicePixelRatio,1/window.devicePixelRatio),this.onResize=this.onResize.bind(this),window.addEventListener("resize",this.onResize),this.onPointerMove=this.onPointerMove.bind(this),0===navigator.maxTouchPoints&&e.addEventListener("pointermove",this.onPointerMove),this.chartDragging=new Dragging(this.pixiApplication,this,e),this.chartZooming=new ChartZooming(this,e),this.chartGridLines=new ChartGridLines(this.pixiApplication),this.chartDataDisplay=new ChartDataDisplay(this.pixiApplication,this,t),this.chartLabels=new ChartLabels(this.pixiApplication,this),this.lastPriceIndicator=new LastPriceIndicator(this.pixiApplication),this.cursor=new ChartCursor(this.pixiApplication,t,a),this.fetchData(!0),this.draw(),this.intervalId=window.setInterval(()=>{let e=this.getBeginningOfInterval(Date.now(),s);if(this.data[this.data.length-1][0]<e.valueOf()){let t=this.data[this.data.length-1][4];this.data.push([e.valueOf(),t,t,t,t,0]),this.draw()}},1e3),this.subscription=c.o.observable.subscribe(e=>{let{resource:t,price:s}=e;if(t!==i)return;let a=this.data[this.data.length-1];a[4]=s,a[2]=Math.max(a[2],s),a[3]=Math.min(a[3],s),this.draw()})}};function Chart_Chart(e){let{style:t,candleInterval:i,market:s}=e,[l,o]=(0,n.useState)(void 0),h=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=new Chart(h.current,t,s,a[i],o);return e.cleanup.bind(e)},[i,t,s]),(0,r.jsxs)("div",{className:"relative h-full w-full select-none overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute",children:l&&(0,r.jsxs)("div",{children:[new Date(l[0]).toLocaleString(),(0,r.jsxs)("div",{className:"flex gap-6",children:[(0,r.jsxs)("div",{children:["O: ",l[1]]}),(0,r.jsxs)("div",{children:["H: ",l[2]]}),(0,r.jsxs)("div",{children:["L: ",l[3]]}),(0,r.jsxs)("div",{children:["C: ",l[4]]})]})]})}),(0,r.jsx)("div",{ref:h,className:"h-full w-full cursor-crosshair overflow-hidden"})]})}function ChartControls(e){let{style:t,candleInterval:i,setCandleInterval:s,setStyle:a}=e,n="bg-blue-500 text-white",l="bg-zinc-800 text-slate-500";return(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{className:"h-8 w-14 rounded-lg px-2 py-1 ".concat("candle"===t?n:l),onClick:()=>a("candle"),children:"Candle"}),(0,r.jsx)("button",{className:"h-8 w-14 rounded-lg px-2 py-1 ".concat("line"===t?n:l),onClick:()=>a("line"),children:"Line"}),(0,r.jsx)("div",{children:(0,r.jsx)("select",{value:i,onChange:e=>s(e.target.value),className:"h-8 rounded-lg bg-zinc-800 px-2 py-1 text-center",children:o.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})})]})}var x=i(251),f=i(3739);function MarketsList(e){let{width:t}=(0,f.iP)(),i=t<1024?MarketsListDropdown:MarketsListSidebar;return(0,r.jsx)(i,{...e})}function MarketsListSidebar(e){let{currentMarket:t,markets:i,onSelectMarket:s}=e,{t:a}=(0,x.$G)();return(0,r.jsx)("div",{className:"flex flex-col gap-1",children:i.map(e=>{let i=e===t?"bg-zinc-600":"bg-zinc-900";return(0,r.jsx)("button",{className:"h-12 border ".concat(i),onClick:()=>s(e),children:a("resource",{context:e})},e)})})}function MarketsListDropdown(e){let{currentMarket:t,markets:i,onSelectMarket:s}=e,{t:a}=(0,x.$G)();return(0,r.jsx)("select",{value:t,onChange:e=>s(e.target.value),className:"h-8 rounded-lg bg-zinc-800 px-2 py-1 text-center",children:i.map(e=>(0,r.jsx)("option",{value:e,children:a("resource",{context:e})},e))})}var m=i(4273),w=i(1927),v=i(9394),b=i(3216),C=i(7660);function OrderHistory(e){let{width:t}=(0,f.iP)(),i=t<1024?CompactOrderHistoryTable:OrderHistoryTable;return(0,r.jsxs)("div",{className:"overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-5xl",children:"Order History"}),e.data.length>0?(0,r.jsx)(i,{...e}):(0,r.jsx)("div",{children:"No orders"})]})}function CompactOrderHistoryTable(e){let{data:t,cancelOrder:i}=e,s=useOrderTable({data:t,cancelOrder:i});return(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)(CollapsibleSortingControls,{table:s}),(0,r.jsx)("table",{className:"w-full",children:s.getRowModel().rows.map(e=>(0,r.jsx)(CompactTableRow,{row:e,cancelOrder:i},e.id))}),(0,r.jsx)(PaginationButtons,{table:s})]})}function CompactTableRow(e){let{row:t,cancelOrder:i}=e,{type:s,side:a,size:n,resource:l,executedPrice:o,status:h,time:c}=t.original,d=t.original.price;return(0,r.jsxs)("tbody",{className:"odd:bg-zinc-900",children:[(0,r.jsxs)("tr",{children:[(0,r.jsxs)("td",{className:"flex gap-4 p-2",children:[s," ",a," ","market"===s&&"buy"===a?"\xa7 "+n+" worth of ":n," ",l,"limit"===s&&" for \xa7 "+d]}),(0,r.jsx)("td",{className:"p-2",children:h}),(0,r.jsxs)("td",{className:"p-2",children:["filled"===h&&(0,r.jsxs)("span",{className:"w-24",children:["fill price: \xa7 ",o]}),"open"===h&&(0,r.jsx)("button",{className:"w-24 rounded border px-1 text-sm",onClick:()=>{i(t.original.id)},children:"Cancel"})]})]}),(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:3,className:"p-2 pt-0",children:new Date(c).toLocaleString()})})]})}function CollapsibleSortingControls(e){let{table:t}=e,[i,s]=(0,n.useState)(!1);return(0,r.jsx)("div",{className:"w-full",children:(0,r.jsxs)(w.fC,{onOpenChange:s,children:[(0,r.jsxs)(w.xz,{className:"mb-2 flex w-28 items-baseline gap-2 rounded-lg border p-2",children:["Sort options ",i?(0,r.jsx)(v.g8U,{}):(0,r.jsx)(v.v4q,{})]}),(0,r.jsx)(w.VY,{children:(0,r.jsx)("div",{className:"flex h-44 flex-col flex-wrap justify-around",children:t.getHeaderGroups().map(e=>e.headers.map(e=>{var t;return(0,r.jsxs)("button",{className:"w-28 rounded-lg border p-2 last:hidden",onClick:e.column.getToggleSortingHandler(),children:[(0,b.ie)(e.column.columnDef.header,e.getContext()),null!==(t=({asc:" \uD83D\uDD3C",desc:" \uD83D\uDD3D"})[e.column.getIsSorted()])&&void 0!==t?t:null]},e.id)}))})})]})})}function OrderHistoryTable(e){let{data:t,cancelOrder:i}=e,s=useOrderTable({data:t,cancelOrder:i});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"whitespace-nowrap uppercase",children:s.getHeaderGroups().map(e=>(0,r.jsx)("tr",{children:e.headers.map(e=>{var t;return(0,r.jsx)("th",{children:e.isPlaceholder?null:(0,r.jsxs)("div",{className:"text-start ".concat(e.column.getCanSort()?"cursor-pointer select-none":""),onClick:e.column.getToggleSortingHandler(),children:[(0,b.ie)(e.column.columnDef.header,e.getContext()),null!==(t=({asc:" \uD83D\uDD3C",desc:" \uD83D\uDD3D"})[e.column.getIsSorted()])&&void 0!==t?t:null]})},e.id)})},e.id))}),(0,r.jsx)("tbody",{children:s.getRowModel().rows.map(e=>(0,r.jsx)("tr",{className:"h-8 odd:bg-zinc-900",children:e.getVisibleCells().map(e=>(0,r.jsx)("td",{children:(0,b.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id))})]}),(0,r.jsx)(PaginationButtons,{table:s})]})}function PaginationButtons(e){let{table:t}=e;return(0,r.jsxs)("div",{className:"mt-2 flex w-full items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{className:"w-6 rounded border bg-gray-800 p-1 text-sm",onClick:()=>t.setPageIndex(0),disabled:!t.getCanPreviousPage(),children:"<<"}),(0,r.jsx)("button",{className:"w-6 rounded border bg-gray-800 p-1 text-sm",onClick:()=>t.previousPage(),disabled:!t.getCanPreviousPage(),children:"<"}),(0,r.jsx)("button",{className:"w-6 rounded border bg-gray-800 p-1 text-sm",onClick:()=>t.nextPage(),disabled:!t.getCanNextPage(),children:">"}),(0,r.jsx)("button",{className:"w-6 rounded border bg-gray-800 p-1 text-sm",onClick:()=>t.setPageIndex(t.getPageCount()-1),disabled:!t.getCanNextPage(),children:">>"})]}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{className:"flex items-center gap-1 whitespace-nowrap",children:(0,r.jsxs)("strong",{children:["Page",(0,r.jsx)("input",{type:"number",min:1,defaultValue:t.getState().pagination.pageIndex+1,onChange:e=>{let i=e.target.value?Number(e.target.value)-1:0;t.setPageIndex(i)},className:"h-[30px] w-10 rounded border bg-gray-800 px-2 text-lg"})," ","of ",t.getPageCount()]})})}),(0,r.jsx)("select",{value:t.getState().pagination.pageSize,onChange:e=>{t.setPageSize(Number(e.target.value))},className:"h-[30px] w-24 rounded border bg-gray-800 px-2 text-lg",children:[10,20,30,40,50].map(e=>(0,r.jsxs)("option",{value:e,children:["Show ",e]},e))})]})}function useOrderTable(e){let{data:t,cancelOrder:i}=e,[s,a]=(0,n.useState)([]),l=(0,C.Cl)(),o=[l.accessor("time",{cell:e=>new Date(e.getValue()).toLocaleString()}),l.accessor("resource",{}),l.accessor("type",{}),l.accessor("side",{}),l.accessor("size",{}),l.accessor("price",{cell:e=>e.getValue()?"\xa7 "+e.getValue():"-"}),l.accessor("percentFilled",{header:"% filled",cell:e=>Math.round(100*e.getValue())}),l.accessor("executedPrice",{header:"fill price",cell:e=>"\xa7 "+e.getValue()}),l.accessor("status",{}),{id:"actions",cell:e=>{let{row:t}=e;if("open"===t.original.status)return(0,r.jsx)("button",{className:"rounded border px-1 text-sm",onClick:()=>{i(t.original.id)},children:"Cancel"})}}];return(0,b.b7)({data:t,columns:o,state:{sorting:s},onSortingChange:a,getCoreRowModel:(0,C.sC)(),getSortedRowModel:(0,C.tj)(),getPaginationRowModel:(0,C.G_)()})}function OrderHistoryContainer(){let e=(0,m.L)(e=>e.orders),t=(0,n.useCallback)(e=>{let t=m.L.getState().orders.find(t=>t.id===e);t&&(t.cancel(),m.L.getState().update(t))},[]);return(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsx)(OrderHistory,{data:e,cancelOrder:t})})}function AmountButtons(e){let{onClick:t}=e;return(0,r.jsxs)("div",{className:"flex w-full justify-stretch gap-2",children:[(0,r.jsx)(AmountButton,{percent:.25,onClick:t}),(0,r.jsx)(AmountButton,{percent:.5,onClick:t}),(0,r.jsx)(AmountButton,{percent:.75,onClick:t}),(0,r.jsx)(AmountButton,{percent:1,onClick:t})]})}function AmountButton(e){let{percent:t,onClick:i}=e;return(0,r.jsxs)("button",{className:"grow rounded-lg border border-gray-500 p-2",onClick:()=>{i(t)},children:[100*t,"%"]})}function InputBox(e){let{label:t,value:i,onChange:s}=e;return(0,r.jsxs)("div",{className:"relative flex items-center",children:[(0,r.jsx)("label",{className:"absolute left-2 uppercase",children:t}),(0,r.jsx)("input",{type:"number",min:"0",className:"h-8 w-full bg-zinc-800 p-2 text-right",value:i||"",onChange:e=>s(e.target.value)})]})}function LimitOrderForm(e){let{side:t,available:i,resource:s}=e,[a,l]=(0,n.useState)(0),[o,h]=(0,n.useState)(0),{t:d}=(0,x.$G)();return(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:["buy"===t&&"Available to spend: \xa7 "+i.toLocaleString(),"sell"===t&&"Available to sell: "+i.toLocaleString()+" "+s,(0,r.jsx)(InputBox,{label:"Limit Price",value:o,onChange:e=>h(Number(e))}),(0,r.jsx)(InputBox,{label:"Amount",value:a,onChange:e=>l(Number(e))}),(0,r.jsx)(AmountButtons,{onClick:e=>l(Math.floor(i*e))}),(0,r.jsxs)("button",{className:"rounded-lg px-4 ".concat("buy"===t?"bg-green-700":"bg-red-700"),onClick:function(){"sell"===t?c.o.limitSell(s,a,o):c.o.limitBuy(s,a,o),l(0),h(0)},children:["buy"===t?"Buy":"Sell"," ",d("resource",{context:s})]})]})}function MarketOrderForm(e){let{side:t,available:i,resource:s}=e,[a,l]=(0,n.useState)(0),{t:o}=(0,x.$G)();return(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:["buy"===t&&"Available to spend: \xa7 "+i.toLocaleString(),"sell"===t&&"Available to sell: "+i.toLocaleString()+" "+s,(0,r.jsx)(InputBox,{label:"Amount",value:a,onChange:e=>l(Number(e))}),(0,r.jsx)(AmountButtons,{onClick:e=>l(Math.floor(i*e))}),(0,r.jsxs)("button",{className:"rounded-lg px-4 ".concat("buy"===t?"bg-green-700":"bg-red-700"),onClick:function(){"sell"===t?c.o.marketSell(s,a):c.o.marketBuy(s,a),l(0)},children:["buy"===t?"Buy":"Sell"," ",o("resource",{context:s})]})]})}function TradeTicket(e){let[t,i]=(0,n.useState)("sell"),[s,a]=(0,n.useState)("market"),l="market"===s?MarketOrderForm:LimitOrderForm,o="buy"===t?e.resources.scrip.quantity:e.resources[e.market].quantity;return(0,r.jsxs)("div",{className:"flex flex-col border border-zinc-500 p-4",children:[(0,r.jsx)(TradeTicketTabs,{side:t,setSide:i,orderType:s,setOrderType:a}),(0,r.jsx)(l,{available:Math.floor(o),resource:e.market,side:t},"".concat(t,"-").concat(e.market))]})}function TradeTicketTabs(e){let{side:t,setSide:i,orderType:s,setOrderType:a}=e,n="border-2 rounded-lg border-blue-200";return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex h-10 justify-between",children:[(0,r.jsx)("button",{className:"w-full ".concat("buy"===t?"border-b-2 border-green-700":""),onClick:()=>{i("buy")},children:"Buy"}),(0,r.jsx)("button",{className:"w-full ".concat("sell"===t?"border-b-2 border-red-700":""),onClick:()=>{i("sell")},children:"Sell"})]}),(0,r.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,r.jsx)("button",{className:"h-8 px-4 ".concat("market"===s?n:""),onClick:()=>{a("market")},children:"Market"}),(0,r.jsx)("button",{className:"h-8 px-4 ".concat("limit"===s?n:""),onClick:()=>{a("limit")},children:"Limit"}),(0,r.jsx)("button",{className:"cursor-not-allowed text-gray-500",disabled:!0,children:"Stop Limit"})]})]})}var S=i(4249),L=i(7180);function Page(){let e=(0,L.o)(e=>e.resources),t=Object.values(e).filter(e=>e.unlocked&&e.type!==S._.Scrip),[i,s]=(0,n.useState)(t[0].type),[a,l]=(0,n.useState)("15m"),[o,h]=(0,n.useState)("candle"),c=(0,n.useCallback)(t=>{t!==S._.Scrip&&s(e[t].type)},[]),d=(0,n.useMemo)(()=>(0,r.jsx)(Chart_Chart,{style:o,candleInterval:a,market:i}),[i,o,a]),u=(0,n.useMemo)(()=>(0,r.jsx)(OrderHistoryContainer,{}),[]),p=(0,n.useMemo)(()=>(0,r.jsx)(MarketsList,{currentMarket:i,markets:t.map(e=>e.type),onSelectMarket:c}),[i,t]),g=(0,n.useMemo)(()=>(0,r.jsx)(ChartControls,{style:o,candleInterval:a,setCandleInterval:l,setStyle:h}),[o,a]);return(0,r.jsxs)("div",{id:"trade-page",children:[(0,r.jsx)("div",{id:"markets-list",children:p}),(0,r.jsx)("div",{id:"chart-controls",children:g}),(0,r.jsx)("div",{id:"chart",className:"h-[40vh] overflow-hidden",children:d}),(0,r.jsx)("div",{id:"trade-ticket",children:(0,r.jsx)(TradeTicket,{resources:e,market:i})}),(0,r.jsx)("div",{id:"order-history",children:u})]})}i(6336)},1568:function(e,t,i){"use strict";i.d(t,{ZA:function(){return a},hM:function(){return r},rs:function(){return l},s7:function(){return n}});var s=i(4249);let a=1094219,r=14289161,n=2763306,l={[s._.Iron]:25,[s._.Carbon]:50,[s._.Gold]:100,[s._.Silicon]:200,[s._.Hydrogen]:350,[s._.Platinum]:0,[s._.Uranium]:0,[s._.Shungite]:0,[s._.Silver]:0,[s._.Copper]:0,[s._.RedMercury]:0,[s._.Titanium]:0,[s._.Scrip]:0}},9954:function(e,t,i){"use strict";function calcPrice(e,t,i){return e+=i(t/35e6,1)*(.8*e),e+=i(t/35e5,1)*(.5*e),e+=i(t/1e5,1)*(.3*e),e+=i(t/1e4,1)*(.2*e),e+=i(t/1e3,1)*(.1*e),Math.round(100*(e+=i(t/100,1)*(.03*e))+Number.EPSILON)/100}i.d(t,{l:function(){return calcPrice}})},5540:function(e,t,i){"use strict";i.d(t,{HH:function(){return MarketOrder},eN:function(){return LimitOrder}});var s=i(7180),a=i(4249);let BaseOrder=class BaseOrder{validate(){throw Error("Method not implemented.")}cancel(){this.status="cancelled";let e="sell"===this.side?this.resource:a._.Scrip;s.o.getState().increase([[e,this.size-this.filled]])}fill(e,t){if("open"!==this.status)throw Error("Order is not open");if(e>this.size-this.filled)throw Error("Fill size is too large");this.filled+=e,this.executedPrice=t,this.filled>=this.size&&(this.status="filled")}get percentFilled(){return this.filled/this.size}constructor(e,t,i,s=Date.now()){this.id=crypto.randomUUID(),this.side=e,this.resource=t,this.size=i,this.time=s,this.filled=0,this.status="open"}};let MarketOrder=class MarketOrder extends BaseOrder{validate(){if(this.size<1)return!1;let e="sell"===this.side?this.resource:a._.Scrip;return s.o.getState().resources[e].quantity>=this.size}static from(e){let t=new MarketOrder(e.side,e.resource,e.size,e.time);return t.id=e.id,t.filled=e.filled,t.status=e.status,t.executedPrice=e.executedPrice,t}constructor(e,t,i,s=Date.now()){super(e,t,i,s),this.type="market"}};let LimitOrder=class LimitOrder extends BaseOrder{validate(){return!(this.size<1)&&("sell"===this.side?s.o.getState().resources[this.resource].quantity>=this.size:s.o.getState().resources[a._.Scrip].quantity>=this.size*this.price)}static from(e){let t=new LimitOrder(e.side,e.resource,e.size,e.price,e.time);return t.id=e.id,t.filled=e.filled,t.status=e.status,t.executedPrice=e.executedPrice,t}constructor(e,t,i,s,a=Date.now()){super(e,t,i,a),this.type="limit",this.price=s}}},7162:function(e,t,i){"use strict";i.d(t,{o:function(){return x}});var s=i(4846),a=i.n(s),r=i(4432),n=i(4185),l=i.n(n),o=i(7973),h=i(1568),c=i(9954),d=i(5540),u=i(4249),p=i(4273),g=i(7180);let x=new class{marketSell(e,t){if(e===u._.Scrip)return;t=Math.floor(t);let i=new d.HH("sell",e,t);if(!i.validate())return;let s=this.getPrice(e);g.o.getState().decrease(e,t),g.o.getState().increase([[u._.Scrip,t*s]]),i.fill(t,s),p.L.getState().add(i)}limitSell(e,t,i){if(e===u._.Scrip)return;(t=Math.floor(t))>Number.MAX_SAFE_INTEGER&&console.warn("too much");let s=new d.eN("sell",e,t,i);if(!s.validate())return;let a=this.getPrice(e);g.o.getState().decrease(e,t),i>a?(p.L.getState().add(s),this._openLimitOrders[e].push(s)):(g.o.getState().increase([[u._.Scrip,t*a]]),s.fill(t,a),p.L.getState().add(s))}marketBuy(e,t){if(e===u._.Scrip)return;t=Math.floor(t);let i=new d.HH("buy",e,t);if(!i.validate())return;let s=this.getPrice(e);g.o.getState().decrease(u._.Scrip,t);let a=t/s;g.o.getState().increase([[e,a]]),i.fill(t,s),p.L.getState().add(i)}limitBuy(e,t,i){if(e===u._.Scrip)return;(t=Math.floor(t))>Number.MAX_SAFE_INTEGER&&console.warn("too much");let s=new d.eN("buy",e,t,i);if(!s.validate())return;let a=this.getPrice(e);i>a?(g.o.getState().decrease(u._.Scrip,t*a),g.o.getState().increase([[e,t]]),s.fill(t,a),p.L.getState().add(s)):(g.o.getState().decrease(u._.Scrip,t*i),p.L.getState().add(s),this._openLimitOrders[e].push(s))}cancelOrder(e){let t=p.L.getState().orders.find(t=>t.id===e);t&&(t.cancel(),p.L.getState().update(t))}get observable(){return this._observable}getPrice(e){let t;switch(e){case u._.Iron:t=this._iron;break;case u._.Carbon:t=this._carbon;break;case u._.Gold:t=this._gold;break;case u._.Silicon:t=this._silicon;break;case u._.Hydrogen:t=this._hydrogen;break;default:return 0}return(0,c.l)(h.rs[e],Date.now()/1e3,t)}generateFakeTrade(){let e=a()(Object.values(u._));if(void 0===e||e===u._.Scrip)return;let t=this.getPrice(e);this._observable.next({resource:e,price:t});let i=this._openLimitOrders[e];if(0===i.length)return;let s=[];for(let a of i)"buy"===a.side?a.price>=t?(g.o.getState().increase([[e,a.size]]),a.fill(a.size,t),p.L.getState().update(a)):s.push(a):a.price<=t?(g.o.getState().increase([[u._.Scrip,a.size*a.price]]),a.fill(a.size,t),p.L.getState().update(a)):s.push(a);this._openLimitOrders[e]=s}constructor(){this._observable=new r.x,this._iron=(0,o.hA)(l()(u._.Iron)),this._carbon=(0,o.hA)(l()(u._.Carbon)),this._gold=(0,o.hA)(l()(u._.Gold)),this._silicon=(0,o.hA)(l()(u._.Silicon)),this._hydrogen=(0,o.hA)(l()(u._.Hydrogen)),this._openLimitOrders={[u._.Scrip]:[],[u._.Iron]:[],[u._.Carbon]:[],[u._.Copper]:[],[u._.Gold]:[],[u._.Platinum]:[],[u._.RedMercury]:[],[u._.Shungite]:[],[u._.Silicon]:[],[u._.Silver]:[],[u._.Titanium]:[],[u._.Uranium]:[],[u._.Hydrogen]:[]},function loop(e){setTimeout(()=>{let e=1e3*Math.random();x.generateFakeTrade(),loop(e)},e)}(1)}}},6336:function(){}},function(e){e.O(0,[310,714,251,396,570,474,273,971,184,744],function(){return e(e.s=5722)}),_N_E=e.O()}]);